<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heroicommits</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            color: #ddd;
            background-color: #1e1e1e;
        }

        h2 {
            color: #61dafb;
        }

        label {
            display: block;
            margin-top: 10px;
        }

        input {
            background: #252526;
            color: #ddd;
            border: 1px solid #333;
            padding: 5px;
            border-radius: 4px;
            width: 200px;
        }

        button {
            margin-top: 15px;
            padding: 8px 16px;
            background: #007acc;
            border: none;
            color: white;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background: #005fa3;
        }

        #result {
            margin-top: 20px;
            font-weight: bold;
        }

        canvas {
            margin-top: 20px;
            background: #fff;
            border-radius: 8px;
        }
    </style>
</head>

<body>
    <h2>Heroicommits</h2>
    <label>From: <input type="date" id="desde"></label>
    <label>to: <input type="date" id="hasta"></label>
    <button id="btnCount">Search for Heroicommits</button>
    <div id="result"></div>    

   
    <div id="plot"></div>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
        // === DATOS DE COMMITS ===
        const commits = [
            { dia: 8, hora: 14 },
            { dia: 8, hora: 14.25 }, // 14:15
            { dia: 8, hora: 15 },
            { dia: 21, hora: 0 },
            { dia: 21, hora: 19 },
            { dia: 21, hora: 19.25 } // 19:15
        ];

        // === TRAZA DE COMMITS ===
        const trace = {
            x: commits.map(c => c.dia),
            y: commits.map(c => c.hora),
            mode: 'markers',
            type: 'scatter',
            marker: {
                size: 10,
                color: '#1f77b4',
                opacity: 0.9,
                line: { color: '#000', width: 1 }
            },
            text: commits.map(c => {
                const hh = Math.floor(c.hora).toString().padStart(2, '0');
                const mm = Math.round((c.hora % 1) * 60).toString().padStart(2, '0');
                return `${hh}:${mm}`;
            }),
            hovertemplate: 'Día %{x}, Hora %{text}<extra></extra>'
        };

        // === FUNCIONES PARA SABADOS Y DOMINGOS ===
        const diasDelMes = Array.from({ length: 31 }, (_, i) => i + 1);
        const primerDiaSemana = 3; // 0=domingo, 1=lunes ... (ej: día 1 = miércoles)
        function esFinDeSemana(dia) {
            const diaSemana = (primerDiaSemana + (dia - 1)) % 7;
            return diaSemana === 0 || diaSemana === 6;
        }

        // === SHAPES ===
        const shapes = [];

        // Franja horaria 9-18
        shapes.push({
            type: 'rect',
            xref: 'paper',
            x0: 0, x1: 1,
            yref: 'y',
            y0: 9, y1: 18,
            fillcolor: 'rgba(255, 200, 0, 0.2)',
            line: { width: 0 }
        });

        // Franjas de sábados y domingos
        diasDelMes.forEach(dia => {
            if (esFinDeSemana(dia)) {
                shapes.push({
                    type: 'rect',
                    xref: 'x',
                    x0: dia - 0.5,
                    x1: dia + 0.5,
                    yref: 'paper',
                    y0: 0,
                    y1: 1,
                    fillcolor: 'rgba(200, 200, 200, 0.3)',
                    line: { width: 0 }
                });
            }
        });

        // === CONFIGURAR EJE Y CON FORMATO HH:MM ===
        const tickVals = [];
        const tickText = [];
        for (let h = 0; h <= 23; h++) {
            tickVals.push(h);
            tickText.push(h.toString().padStart(2, '0') + ':00');
        }

        // === LAYOUT ===
        const layout = {
            title: 'Commits por día y hora (con franjas y fines de semana)',
            xaxis: { title: 'Día del mes', range: [1, 31], dtick: 1 },
            yaxis: { title: 'Hora del día', range: [0, 23], tickvals: tickVals, ticktext: tickText },
            hovermode: 'x',  // muestra todos los commits del mismo día
            shapes: shapes,
            margin: { t: 50, r: 20, b: 50, l: 60 },
            height: 600,
            hovermode:'y'
        };

        // === PLOTEAR ===
        Plotly.newPlot('plot', [trace], layout);
    </script>




    
</body>
</html>